{"paragraphs":[{"text":"import org.joda.time.Days\nimport org.joda.time.format.DateTimeFormat\nimport org.joda.time.Months\nval endMonth = \"201909\"\nval startMonth = \"201704\"\nval originalFormat = DateTimeFormat.forPattern(\"yyyyMM\")\nval parsedStartMonth = originalFormat.parseDateTime(startMonth)\nval parsedEndMonth =  originalFormat.parseDateTime(endMonth)\n//val filterMonth = parsedYearMonth.toString(\"yyyy-MM\")\n//val monthsGap = parsedEndMonth.minus(parsedStartMonth)\n val durationMonths = Months.monthsBetween(parsedStartMonth,parsedEndMonth).getMonths()\n","user":"anonymous","dateUpdated":"2019-11-16T22:35:08+0900","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.joda.time.Days\nimport org.joda.time.format.DateTimeFormat\nimport org.joda.time.Months\nendMonth: String = 201909\nstartMonth: String = 201704\noriginalFormat: org.joda.time.format.DateTimeFormatter = org.joda.time.format.DateTimeFormatter@74c56817\nparsedStartMonth: org.joda.time.DateTime = 2017-04-01T00:00:00.000+09:00\nparsedEndMonth: org.joda.time.DateTime = 2019-09-01T00:00:00.000+09:00\ndurationMonths: Int = 29\n"}]},"apps":[],"jobName":"paragraph_1573708112481_-25630429","id":"20191108-120635_1739504120","dateCreated":"2019-11-14T14:08:32+0900","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:376","dateFinished":"2019-11-16T22:35:25+0900","dateStarted":"2019-11-16T22:35:08+0900"},{"text":"(0 to durationMonths-1).map(i => {\n    \n    val currMonth = parsedStartMonth.plusMonths(i).toString(\"yyyy-MM\")\n    val currMonthPath = s\"${monthWiseUsersPath}/${currMonth}/*\"\n    val currMonthDF = spark.read.parquet(currMonthPath).distinct()\n    \n    println(currMonth,currMonthDF.count())\n    \n})","user":"anonymous","dateUpdated":"2019-11-16T22:35:54+0900","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2017-04/*,765571)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2017-05/*,832078)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2017-06/*,944784)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2017-07/*,1065228)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2017-08/*,1183231)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2017-09/*,1259155)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2017-10/*,1330537)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2017-11/*,1413900)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2017-12/*,1539101)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2018-01/*,1624200)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2018-02/*,1685391)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2018-03/*,1786778)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2018-04/*,1884052)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2018-05/*,1974872)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2018-06/*,2074348)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2018-07/*,2181474)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2018-08/*,2298850)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2018-09/*,2407153)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2018-10/*,2506474)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2018-11/*,2620616)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2018-12/*,2758291)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2019-01/*,2895657)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2019-02/*,2988988)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2019-03/*,3181301)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2019-04/*,3310694)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2019-05/*,3495805)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2019-06/*,3773985)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2019-07/*,3949808)\n(s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2019-08/*,4164807)\nres26: scala.collection.immutable.IndexedSeq[Unit] = Vector((), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), ())\n"}]},"apps":[],"jobName":"paragraph_1573708112489_-988133709","id":"20191108-121852_2044205546","dateCreated":"2019-11-14T14:08:32+0900","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:377"},{"text":"val julyDF = \"s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2019-07/*\"\nval augDF =\"s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2019-08/*\"\nval septDF =\"s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2019-09/*\"","user":"anonymous","dateUpdated":"2019-11-14T14:08:32+0900","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"julyDF: String = s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2019-07/*\naugDF: String = s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2019-08/*\nseptDF: String = s3a://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2019-09/*\n"}]},"apps":[],"jobName":"paragraph_1573708112492_1804387949","id":"20191111-031414_1406240323","dateCreated":"2019-11-14T14:08:32+0900","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:378"},{"text":"%sh\naws s3 ls s3://docomo-osusume-data/Bhavani/month_wise_unique_users_appuseLiteracy/2019-09/ | wc -l","user":"anonymous","dateUpdated":"2019-11-14T14:08:32+0900","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"201\n"}]},"apps":[],"jobName":"paragraph_1573708112492_-849412732","id":"20191111-031805_1880725351","dateCreated":"2019-11-14T14:08:32+0900","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:379"},{"text":"val idDF = spark.read.parquet(julyDF,augDF,septDF).distinct","user":"anonymous","dateUpdated":"2019-11-14T14:08:32+0900","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"idDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [imei: string]\n"}]},"apps":[],"jobName":"paragraph_1573708112494_-983271991","id":"20191111-031554_266391513","dateCreated":"2019-11-14T14:08:32+0900","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:380"},{"text":"idDF.count","user":"anonymous","dateUpdated":"2019-11-14T14:08:32+0900","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res27: Long = 4459150\n"}]},"apps":[],"jobName":"paragraph_1573708112495_189854732","id":"20191111-031630_1434044812","dateCreated":"2019-11-14T14:08:32+0900","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:381"},{"text":"val appUsePath04 = \"s3a://docomo-osusume-data/Bhavani/raw_data/appuse_literacy_log/2018-07-*/*\"","user":"anonymous","dateUpdated":"2019-11-14T14:08:32+0900","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"appUsePath04: String = s3a://docomo-osusume-data/Bhavani/raw_data/appuse_literacy_log/2018-07-*/*\n"}]},"apps":[],"jobName":"paragraph_1573708112495_-1178762447","id":"20191108-120929_876247546","dateCreated":"2019-11-14T14:08:32+0900","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:382"},{"text":"val df = spark.read.parquet(appUsePath04).select(\"imei\").distinct()\ndf.printSchema()","user":"anonymous","dateUpdated":"2019-11-14T14:08:32+0900","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- imei: string (nullable = true)\n\ndf: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [imei: string]\n"}]},"apps":[],"jobName":"paragraph_1573708112497_1357215367","id":"20191108-124736_874975597","dateCreated":"2019-11-14T14:08:32+0900","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:383"},{"text":"df.count()","user":"anonymous","dateUpdated":"2019-11-14T14:08:32+0900","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1573708112498_69613308","id":"20191108-124814_1524513435","dateCreated":"2019-11-14T14:08:32+0900","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:384"},{"user":"anonymous","dateUpdated":"2019-11-14T14:08:32+0900","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1573708112501_1146735572","id":"20191108-124937_1567999618","dateCreated":"2019-11-14T14:08:32+0900","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:385"}],"name":"month_wise_unique_app_users_20191111","id":"2ERTFZ2JZ","noteParams":{},"noteForms":{},"angularObjects":{"sh:shared_process":[],"file:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}