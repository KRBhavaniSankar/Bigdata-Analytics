{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1573006884912_870447554","id":"20191106-112124_1316842004","dateCreated":"2019-11-06T11:21:24+0900","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1784","text":"import java.util.TimeZone\nTimeZone.setDefault(TimeZone.getTimeZone(\"UTC\"))\n","dateUpdated":"2019-11-06T11:36:37+0900","dateFinished":"2019-11-06T11:36:37+0900","dateStarted":"2019-11-06T11:36:37+0900","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import java.util.TimeZone\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1573007191610_-1914497630","id":"20191106-112631_938261940","dateCreated":"2019-11-06T11:26:31+0900","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2031","text":"spark.conf.get(\"spark.sql.session.timeZone\")","dateUpdated":"2019-11-06T11:50:27+0900","dateFinished":"2019-11-06T11:50:28+0900","dateStarted":"2019-11-06T11:50:27+0900","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res28: String = UTC\n"}]}},{"text":"val df = spark.read.option(\"spark.sql.session.timeZone\",\"UTC\").parquet(path).filter($\"min_event_date\".between(\"2017-05-01 00:00:00\",\"2017-11-30 23:59:59\"))\ndf.show(false)\ndf.printSchema()","user":"anonymous","dateUpdated":"2019-11-06T11:37:09+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+-------------------+------------------------+-------------------------------------------+---------------------------------------------------------------------+----------+-------------------+-------------------+\n|min_event_date     |3hour_before_ts    |imei                    |package_name                               |class_name                                                           |event_type|event_date         |update_date        |\n+-------------------+-------------------+------------------------+-------------------------------------------+---------------------------------------------------------------------+----------+-------------------+-------------------+\n|2017-09-27 14:22:36|2017-09-27 11:22:36|05O55G5555Q0Q4JTP4Q055PG|com.nttdocomo.android.dhome                |com.nttdocomo.android.dhome.HomeActivity                             |1         |2017-09-27 14:13:31|2017-09-28 12:13:10|\n|2017-09-27 14:22:36|2017-09-27 11:22:36|05O55G5555Q0Q4JTP4Q055PG|jp.co.nttdocomo.carriermail                |jp.co.nttdocomo.carriermail.activity.FolderListActivity              |1         |2017-09-27 14:08:21|2017-09-28 12:13:10|\n|2017-09-27 14:22:36|2017-09-27 11:22:36|05O55G5555Q0Q4JTP4Q055PG|com.nttdocomo.android.dhome                |com.nttdocomo.android.dhome.HomeActivity                             |1         |2017-09-27 14:12:43|2017-09-28 12:13:10|\n|2017-09-27 14:22:36|2017-09-27 11:22:36|05O55G5555Q0Q4JTP4Q055PG|jp.co.nttdocomo.carriermail                |jp.co.nttdocomo.carriermail.activity.MailListActivity                |2         |2017-09-27 14:05:45|2017-09-28 12:13:10|\n|2017-09-27 14:22:36|2017-09-27 11:22:36|05O55G5555Q0Q4JTP4Q055PG|jp.co.nttdocomo.carriermail                |jp.co.nttdocomo.carriermail.activity.MailListActivity                |2         |2017-09-27 14:09:03|2017-09-28 12:13:10|\n|2017-09-27 14:22:36|2017-09-27 11:22:36|05O55G5555Q0Q4JTP4Q055PG|com.nttdocomo.android.dhome                |com.nttdocomo.android.dhome.HomeActivity                             |1         |2017-09-27 14:10:44|2017-09-28 12:13:10|\n|2017-09-27 14:22:36|2017-09-27 11:22:36|05O55G5555Q0Q4JTP4Q055PG|jp.co.sharp.android.restoreguide           |jp.co.sharp.android.restoreguide.MainActivity                        |2         |2017-09-27 14:08:04|2017-09-28 12:13:10|\n|2017-09-27 14:22:36|2017-09-27 11:22:36|05O55G5555Q0Q4JTP4Q055PG|jp.co.nttdocomo.carriermail                |jp.co.nttdocomo.carriermail.activity.EulaViewer                      |1         |2017-09-27 14:08:21|2017-09-28 12:13:10|\n|2017-09-27 14:22:36|2017-09-27 11:22:36|05O55G5555Q0Q4JTP4Q055PG|jp.co.sharp.android.restoreguide           |jp.co.sharp.android.restoreguide.MainActivity                        |1         |2017-09-27 14:12:48|2017-09-28 12:13:10|\n|2017-09-27 14:22:36|2017-09-27 11:22:36|05O55G5555Q0Q4JTP4Q055PG|com.android.chrome                         |org.chromium.chrome.browser.customtabs.SeparateTaskCustomTabActivity |2         |2017-09-27 14:05:30|2017-09-28 12:13:10|\n|2017-09-27 14:22:36|2017-09-27 11:22:36|05O55G5555Q0Q4JTP4Q055PG|jp.co.nttdocomo.carriermail                |jp.co.nttdocomo.carriermail.activity.MailListActivity                |1         |2017-09-27 14:05:44|2017-09-28 12:13:10|\n|2017-09-27 14:22:36|2017-09-27 11:22:36|05O55G5555Q0Q4JTP4Q055PG|com.nttdocomo.android.dhome                |com.nttdocomo.android.dhome.HomeActivity                             |2         |2017-09-27 14:06:02|2017-09-28 12:13:10|\n|2017-09-27 14:22:36|2017-09-27 11:22:36|05O55G5555Q0Q4JTP4Q055PG|jp.co.sharp.android.shinstructionmanual04hb|jp.co.sharp.android.shinstructionmanual04hb.InstructionManualActivity|2         |2017-09-27 14:13:46|2017-09-28 12:13:10|\n|2017-09-27 14:22:36|2017-09-27 11:22:36|05O55G5555Q0Q4JTP4Q055PG|com.android.chrome                         |org.chromium.chrome.browser.document.ChromeLauncherActivity          |2         |2017-09-27 14:01:00|2017-09-28 12:13:10|\n|2017-09-27 14:22:36|2017-09-27 11:22:36|05O55G5555Q0Q4JTP4Q055PG|jp.co.nttdocomo.carriermail                |jp.co.nttdocomo.carriermail.e6                                       |1         |2017-09-27 12:34:46|2017-09-28 12:13:10|\n|2017-09-27 14:22:36|2017-09-27 11:22:36|05O55G5555Q0Q4JTP4Q055PG|jp.co.nttdocomo.carriermail                |jp.co.nttdocomo.carriermail.e6                                       |2         |2017-09-27 14:05:49|2017-09-28 12:13:10|\n|2017-09-27 14:22:36|2017-09-27 11:22:36|05O55G5555Q0Q4JTP4Q055PG|com.nttdocomo.android.dhome                |com.nttdocomo.android.dhome.HomeActivity                             |2         |2017-09-27 14:08:44|2017-09-28 12:13:10|\n|2017-09-27 14:22:36|2017-09-27 11:22:36|05O55G5555Q0Q4JTP4Q055PG|jp.co.nttdocomo.carriermail                |jp.co.nttdocomo.carriermail.hp                                       |1         |2017-09-27 14:09:03|2017-09-28 12:13:10|\n|2017-09-27 14:22:36|2017-09-27 11:22:36|05O55G5555Q0Q4JTP4Q055PG|com.nttdocomo.android.dhome                |com.nttdocomo.android.dhome.HomeActivity                             |2         |2017-09-27 14:13:47|2017-09-28 12:13:10|\n|2017-09-27 14:22:36|2017-09-27 11:22:36|05O55G5555Q0Q4JTP4Q055PG|com.nttdocomo.android.dhome                |com.nttdocomo.android.dhome.HomeActivity                             |1         |2017-09-27 14:05:30|2017-09-28 12:13:10|\n+-------------------+-------------------+------------------------+-------------------------------------------+---------------------------------------------------------------------+----------+-------------------+-------------------+\nonly showing top 20 rows\n\nroot\n |-- min_event_date: timestamp (nullable = true)\n |-- 3hour_before_ts: timestamp (nullable = true)\n |-- imei: string (nullable = true)\n |-- package_name: string (nullable = true)\n |-- class_name: string (nullable = true)\n |-- event_type: integer (nullable = true)\n |-- event_date: timestamp (nullable = true)\n |-- update_date: timestamp (nullable = true)\n\ndf: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [min_event_date: timestamp, 3hour_before_ts: timestamp ... 6 more fields]\n"}]},"apps":[],"jobName":"paragraph_1572933406038_-510521000","id":"20191105-145646_1421033812","dateCreated":"2019-11-05T14:56:46+0900","dateStarted":"2019-11-06T11:37:09+0900","dateFinished":"2019-11-06T11:37:19+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:359"},{"text":"df.select(\"min_event_date\").distinct.count()","user":"anonymous","dateUpdated":"2019-11-06T11:37:25+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res24: Long = 113485\n"}]},"apps":[],"jobName":"paragraph_1572937301603_767155365","id":"20191105-160141_1378009663","dateCreated":"2019-11-05T16:01:41+0900","dateStarted":"2019-11-06T11:37:25+0900","dateFinished":"2019-11-06T11:38:30+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:360"},{"text":"%sh\nls /Users/bhavani.sankar/Desktop/Proj/Asurion/Tasks/Parinda/2_appUse_logs_extraction_20191101/","user":"anonymous","dateUpdated":"2019-11-05T16:21:56+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"201705-201711_output\ndate_generation.sh\nimei_minEventDate_201705_201902_1101_v1.csv\nimei_minEventDate_201705_201902_1105_v2.csv\nspark-submit-command\ntrouble_users.sh\n"}]},"apps":[],"jobName":"paragraph_1572934070436_-1983814395","id":"20191105-150750_406702711","dateCreated":"2019-11-05T15:07:50+0900","dateStarted":"2019-11-05T16:21:56+0900","dateFinished":"2019-11-05T16:21:56+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:362"},{"text":"val imeiDF = spark.read\n.option(\"header\",\"true\")\n.option(\"inferSchema\",\"true\")\n.csv(imeiPath)\n.drop($\"_c0\")\n.withColumnRenamed(\"IMEI\",\"imei\")\n.filter($\"min_event_date\".between(\"2017-05-01 00:00:00\",\"2017-11-30 23:59:59\"))\n\nimeiDF.show(10,false)\nimeiDF.printSchema()\nimeiDF.count()","user":"anonymous","dateUpdated":"2019-11-06T11:52:41+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-------------------+-------------------+------------------------+\n|CASE_ID             |TIMESTAMP          |min_event_date     |imei                    |\n+--------------------+-------------------+-------------------+------------------------+\n|20170825_In_09950_01|2017-08-25 16:48:54|2017-08-25 16:34:14|N5O55O5555Q4O4OTP4N055PL|\n|20170828_In_11907_01|2017-08-28 18:00:01|2017-08-28 17:52:09|O5O55O5455QL44NTP40055PJ|\n|20170819_In_02998_01|2017-08-19 11:25:52|2017-08-19 11:13:29|NTOGJJO455TOQ5TTP4QTTTP4|\n|20170819_In_04913_03|2017-08-19 13:01:35|2017-08-19 12:56:54|J5O55T5J55QTG4GTP4T055PL|\n|20170808_In_08510_01|2017-08-08 16:27:27|2017-08-08 16:12:21|J5O55N5T55Q5J4TTP45055P0|\n|20170814_In_12143_01|2017-08-14 19:50:19|2017-08-14 19:45:51|O5O55N5T55QO04GTP4L055P4|\n|20170827_In_12843_01|2017-08-27 19:40:22|2017-08-27 19:28:09|G5O5545455QGG4TTP4Q055P5|\n|20170805_In_08141_01|2017-08-05 16:10:58|2017-08-05 16:00:32|Q4LN4JJT5JGQN4NTP44L5TPO|\n|20170827_In_01929_02|2017-08-27 10:29:08|2017-08-27 09:33:58|05O55O5555QQG45TP44055PL|\n|20170819_In_10417_01|2017-08-19 17:01:46|2017-08-19 16:27:01|L5O5505T55Q554LTP4Q055P4|\n+--------------------+-------------------+-------------------+------------------------+\nonly showing top 10 rows\n\nroot\n |-- CASE_ID: string (nullable = true)\n |-- TIMESTAMP: timestamp (nullable = true)\n |-- min_event_date: timestamp (nullable = true)\n |-- imei: string (nullable = true)\n\nimeiDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [CASE_ID: string, TIMESTAMP: timestamp ... 2 more fields]\nres29: Long = 136329\n"}]},"apps":[],"jobName":"paragraph_1572934023387_394700076","id":"20191105-150703_1493347487","dateCreated":"2019-11-05T15:07:03+0900","dateStarted":"2019-11-06T11:52:41+0900","dateFinished":"2019-11-06T11:52:50+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:363"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1573007995812_170700540","id":"20191106-113955_2089157645","dateCreated":"2019-11-06T11:39:55+0900","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2651","text":"val joinDF1 = df.join(imeiDF, Seq(\"imei\",\"min_event_date\"),\"inner\")\njoinDF1.show(10,false)\njoinDF1.printSchema()\n","dateUpdated":"2019-11-06T11:40:52+0900","dateFinished":"2019-11-06T11:42:20+0900","dateStarted":"2019-11-06T11:40:52+0900","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------------+-------------------+-------------------+---------------------------------+---------------------------------------------+----------+-------------------+-------------------+--------------------+-------------------+\n|imei                    |min_event_date     |3hour_before_ts    |package_name                     |class_name                                   |event_type|event_date         |update_date        |CASE_ID             |TIMESTAMP          |\n+------------------------+-------------------+-------------------+---------------------------------+---------------------------------------------+----------+-------------------+-------------------+--------------------+-------------------+\n|05JT5J5555OO44OTP4O454PO|2017-11-11 16:23:13|2017-11-11 13:23:13|com.sonyericsson.home            |com.sonymobile.home.HomeActivity             |2         |2017-11-11 16:17:17|2017-11-11 18:16:32|20171111_In_10024_01|2017-11-11 16:28:01|\n|05JT5J5555OO44OTP4O454PO|2017-11-11 16:23:13|2017-11-11 13:23:13|com.sonyericsson.home            |com.sonymobile.home.HomeActivity             |1         |2017-11-11 13:48:48|2017-11-11 18:16:32|20171111_In_10024_01|2017-11-11 16:28:01|\n|05JT5J5555OO44OTP4O454PO|2017-11-11 16:23:13|2017-11-11 13:23:13|com.android.settings             |com.android.settings.Settings                |2         |2017-11-11 16:16:03|2017-11-11 18:16:32|20171111_In_10024_01|2017-11-11 16:28:01|\n|05JT5J5555OO44OTP4O454PO|2017-11-11 16:23:13|2017-11-11 13:23:13|com.sonyericsson.home            |com.sonymobile.home.HomeActivity             |1         |2017-11-11 16:15:36|2017-11-11 18:16:32|20171111_In_10024_01|2017-11-11 16:28:01|\n|05JT5J5555OO44OTP4O454PO|2017-11-11 16:23:13|2017-11-11 13:23:13|com.amazon.mShop.android.shopping|com.amazon.mShop.splashscreen.StartupActivity|2         |2017-11-11 15:34:09|2017-11-11 18:16:32|20171111_In_10024_01|2017-11-11 16:28:01|\n|05JT5J5555OO44OTP4O454PO|2017-11-11 16:23:13|2017-11-11 13:23:13|com.android.dialer               |com.android.dialer.NextiDialtactsActivity    |1         |2017-11-11 16:18:38|2017-11-11 18:16:32|20171111_In_10024_01|2017-11-11 16:28:01|\n|05JT5J5555OO44OTP4O454PO|2017-11-11 16:23:13|2017-11-11 13:23:13|com.amazon.mShop.android.shopping|com.amazon.mShop.cart.web.WebCartActivity    |2         |2017-11-11 15:34:50|2017-11-11 18:16:32|20171111_In_10024_01|2017-11-11 16:28:01|\n|05JT5J5555OO44OTP4O454PO|2017-11-11 16:23:13|2017-11-11 13:23:13|com.sonyericsson.home            |com.sonymobile.home.HomeActivity             |2         |2017-11-11 15:35:42|2017-11-11 18:16:32|20171111_In_10024_01|2017-11-11 16:28:01|\n|05JT5J5555OO44OTP4O454PO|2017-11-11 16:23:13|2017-11-11 13:23:13|com.sonyericsson.home            |com.sonymobile.home.HomeActivity             |2         |2017-11-11 16:00:49|2017-11-11 18:16:32|20171111_In_10024_01|2017-11-11 16:28:01|\n|05JT5J5555OO44OTP4O454PO|2017-11-11 16:23:13|2017-11-11 13:23:13|com.android.dialer               |com.android.dialer.NextiDialtactsActivity    |1         |2017-11-11 16:03:32|2017-11-11 18:16:32|20171111_In_10024_01|2017-11-11 16:28:01|\n+------------------------+-------------------+-------------------+---------------------------------+---------------------------------------------+----------+-------------------+-------------------+--------------------+-------------------+\nonly showing top 10 rows\n\nroot\n |-- imei: string (nullable = true)\n |-- min_event_date: timestamp (nullable = true)\n |-- 3hour_before_ts: timestamp (nullable = true)\n |-- package_name: string (nullable = true)\n |-- class_name: string (nullable = true)\n |-- event_type: integer (nullable = true)\n |-- event_date: timestamp (nullable = true)\n |-- update_date: timestamp (nullable = true)\n |-- CASE_ID: string (nullable = true)\n |-- TIMESTAMP: timestamp (nullable = true)\n\njoinDF1: org.apache.spark.sql.DataFrame = [imei: string, min_event_date: timestamp ... 8 more fields]\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1573008146426_-676532832","id":"20191106-114226_548602685","dateCreated":"2019-11-06T11:42:26+0900","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2750","text":"joinDF1.select(\"min_event_date\").distinct.count()","dateUpdated":"2019-11-06T11:42:59+0900","dateFinished":"2019-11-06T11:44:35+0900","dateStarted":"2019-11-06T11:42:59+0900","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res27: Long = 113485\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1572933763215_44453203","id":"20191105-150243_665536930","dateCreated":"2019-11-05T15:02:43+0900","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:369"}],"name":"3hours_logs_data_prepartions_20191105","id":"2ETWY1BR2","noteParams":{},"noteForms":{},"angularObjects":{"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}